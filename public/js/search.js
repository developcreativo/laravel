function deletetr(id) {    $('#' + id).html('');    subtotal();}var i = 1;function agregaritems(id, valor, nombre) {    var successContent = '<tr class ="dato" id="' + i + '"><td><input class="form-control input-sm" value="' + id + '" name="items[' + i + '][producto_configurable]" type="text" readonly></td>' +        '<td><input class="form-control input-sm cant" onkeyup="obtenerDatos(' + i + ')" value="1" name="items[' + i + '][cantidad]" type="text" id="cantidad' + i + '"></td>' +        '<td><input class="form-control input-sm" value="' + nombre + '" name="items[' + i + '][producto]" type="text" disabled></td>' +        '<td><input class="form-control input-sm val" onkeyup="obtenerDatos(' + i + ')" value="' + valor + '" name="items[' + i + '][valor]" id="valor' + i + '" type="text"></td>' +        '<td><input class="form-control input-sm iva" onkeyup="obtenerDatos(' + i + ')" value="0" name="items[' + i + '][iva]" id="iva' + i + '" type="text" ></td>' +        '<td><input class="form-control input-sm dto" onkeyup="obtenerDatos(' + i + ')" value="0" name="items[' + i + '][dto]" id="dto' + i + '" type="text" ></td>' +        '<td><input class="form-control input-sm sub" value="' + valor + '" name="items[' + i + '][sub_total]" id="sub_total' + i + '" type="text" readonly ></td>' +        '<td> <a class="btn btn-danger btn-sm" href="#" onclick="return deletetr(' + i + ')"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a></td></tr>';    $('#tabla-todos').append(successContent);    $('#buscar').val('');    i++;    subtotal();    //$('#productos-sugeridos').html('');}function obtenerDatos(id) {    var celda_cantidad = '[id=cantidad' + id + ']',        celda_valor = '[id=valor' + id + ']',        celda_iva = '[id=iva' + id + ']',        celda_dto = '[id=dto' + id + ']',        celda_sub_total = '[id=sub_total' + id + ']',        cantidad = parseInt($(celda_cantidad).val()),        valor = parseInt($(celda_valor).val()),        iva = parseFloat(parseInt($(celda_iva).val()) / 100),        dto = parseFloat(parseInt($(celda_dto).val()) / 100);    var subtotal1 = (valor) * (cantidad);    var resultado2 = (1 + iva) * (1 - dto);    var resultado = ((subtotal1) * (resultado2));    $(celda_sub_total).val(resultado.toFixed(2));    //alert(cantidad);*/    //console.log("center: "+cantidad);    subtotal();}function subtotal() {    var suma = 0, iva = 0, subDTO = 0, Subtotal = 0, subIVA = 0, rete = 0;    $('#tabla-todos tr').each(function () { //filas con clase 'dato', especifica una clase, asi no tomas el nombre de las columnas        suma += parseInt($(this).find('.sub').val() || 0, 10) //numero de la celda 3        subDTO += (parseInt($(this).find('.cant').val()) * parseInt($(this).find('.val').val()) * (parseFloat($(this).find('.dto').val() / 100))) || 0, 10        subIVA += (parseInt($(this).find('.cant').val()) * parseInt($(this).find('.val').val()) * (parseFloat($(this).find('.iva').val() / 100))) || 0, 10    })    rete = parseInt($('#compras #rete').val()) || 0    Subtotal = suma - rete    suma = suma + subDTO - subIVA    //alert(suma)    $('#compras #subT').val(suma.toFixed(2));    $('#compras #DTO').val(-subDTO.toFixed(2));    $('#compras #iva').val(subIVA.toFixed(2));    $('#compras #total').val(Subtotal.toFixed(2));}$('#buscar').keyup(function () {    $('#productos-sugeridos').html('');    term = $('#buscar').val()    var data = $('#productos-sugeridos').data("productos"); //obtengo los productos que cargue    var successContent = '';    var i = 0    if (term.length > 1) {        for ( datos in data) {            if (data[datos].producto.match(term)) {                successContent += '<a href="#" class="list-group-item" onclick="return agregaritems(\'' +                    data[datos].id + '\',\'' + data[datos].productos.compra + '\',\'' + data[datos].producto + '\')">' +                    data[datos].producto + '<span class="badge badge-info">'+ data[datos].productos.marcas.marca +'</span> </a>';                i++            }            if(i===3){                break;            }        }    }    $('#productos-sugeridos').html(successContent);});